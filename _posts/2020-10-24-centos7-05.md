---
layout:     post
title:      CentOS 7 study notes (5)
subtitle:   Basic Linux commands
date:       2020-10-24
author:     Chen Xingxu
header-img: img/post-bg-road.jpg
catalog:    true
tags:
    - CentOS
---

# 05.CentOS7学习笔记--Linux基本命令

Linux 命令用法一般用 man 命令可以查看其帮助信息。

下面给出了一些比较常用的命令。推荐一个 Linux 命令快查网站，非常不错，大家如果遗忘某些命令或者对某些命令不理解都可以在这里得到解决。

中文 Linux 命令帮助大全：http://man.linuxde.net/

## 目录切换命令

- `cd usr`： 切换到该目录下 usr 目录
- `cd ..`（或`cd../`）： 切换到上一层目录
- `cd /`： 切换到系统根目录
- `cd ~`： 切换到用户主目录
- `cd -`： 切换到上一个所在目录

## 目录的操作命令（增删改查）

**1、`mkdir 目录名称`： 增加目录**

**2、`ls` 或者 `ll`（`ll` 是 `ls -l` 的缩写，`ll` 命令以看到该目录下的所有目录和文件的详细信息）：查看目录信息**

**3、`find 目录 参数`： 寻找目录（查）**

示例：

```bash
# 列出当前目录及子目录下所有文件和文件夹
find .
# 在/home目录下查找以.txt结尾的文件名
find /home -name "*.txt"
# 同上，但忽略大小写
find /home -iname "*.txt"
# 当前目录及子目录下查找所有以.txt和.pdf结尾的文件
find . \( -name "*.txt" -o -name "*.pdf" \)
# 或
find . -name "*.txt" -o -name "*.pdf"
```

**4、`mv 目录名称 新目录名称`： 修改目录的名称（改）**

注意：`mv` 的语法不仅可以对目录进行重命名而且也可以对各种文件、压缩包等进行 重命名的操作。`mv` 命令用来对文件或目录重新命名，或者将文件从一个目录移到另一个目录中。后面会介绍到 `mv` 命令的另一个用法。

**5、`mv 目录名称 目录的新位置`： 移动目录的位置---剪切（改）**

注意：`mv` 语法不仅可以对目录进行剪切操作，对文件和压缩包等都可执行剪切操作。另外 `mv` 与 `cp` 的结果不同，`mv` 好像文件“搬家”，文件个数并未增加。而 `cp` 对文件进行复制，文件个数增加了。

**6、`cp -r 目录名称 目录拷贝的目标位置`： 拷贝目录（改），-r 代表递归拷贝**

注意：`cp` 命令不仅可以拷贝目录还可以拷贝文件、压缩包等，拷贝文件和压缩包时不用写 -r 递归。

**7、`rm [-rf] 目录`：删除目录（删）**

注意：`rm` 不仅可以删除目录，也可以删除其他文件或压缩包，为了增强大家的记忆， 无论删除任何目录或文件，都直接使用`rm -rf 目录/文件/压缩包`。

## 文件的操作命令（增删改查）

**1、`touch 文件名称`：文件的创建（增）**

**2、`cat /more/less/tail 文件名称`：文件的查看（查）**

- `cat`： 只能显示最后一屏内容
- `more`： 可以显示百分比，回车可以向下一行， 空格可以向下一页，q 可以退出查看
- `less`： 可以使用键盘上的 PgUp 和 PgDn 向上和向下翻页，q 结束查看
- `head -10` ： 查看文件的前 10 行，Ctrl+C 结束
- `tail -10` ： 查看文件的后 10 行，Ctrl+C 结束

注意：命令 `tail -f 文件` 可以对某个文件进行动态监控，例如 Tomcat 的日志文件，会随着程序的运行，日志会变化，可以使用 `tail -f catalina-2020-09-10.log` 监控文件的变化。

**3、vim 文件： 修改文件的内容（改）**

vim 编辑器是 Linux 中的强大组件，是 vi 编辑器的加强版，vim 编辑器的命令和快捷方式有很多，这里列出一些常用命令。

在实际开发中，使用 vim 编辑器主要作用就是修改配置文件和编写 shell 脚本，下面是一般步骤：

vim 文件 ------> 进入文件 -----> 命令模式 ------> 按 i 进入编辑模式 -----> 编辑文件 -------> 按 Esc 进入底行模式 -----> 输入 `:wq` 或 `q!` （输入 wq 代表写入内容并退出，即保存；输入 q! 代表强制退出不保存。）

**命令模式**

用 vim 打开一个文件刚开始进入的就是命令模式，在这个模式下我们可以控制光标的移动、字符、字或者行的删除、移动复制某段区域，在该模式下可以进入插入模式也可以进入底行模式。

**编辑模式**

在编辑模式下才可以插入文字，按 Esc 进入底行模式。

**底行模式**

在底行模式下保存文件或者退出 vim。

**4、vim 常用命令**

1. 移动光标
   1. vim 可以使用小写英文字母 h j k l 分别控制光标左 下 上 右移动，也可以使用箭头
   2. Ctrl+b 屏幕往后移动一页
   3. Ctrl+f 屏幕往前移动一页
   4. Ctrl+u 屏幕往后移动半页
   5. Ctrl+d 屏幕往前移动半页
   6. Shift+g == G 移动到文章的最后
   7. Shift+4 == $ 移动到光标所在行的行尾
   8. Shift+6 == ^ 移动到光标所在行的行首
   9. w 光标跳到下个字的开头
   10. e 光标跳到下个字的字尾
   11. b 光标回到上个字的开头
   12. #l 例如 5l，56l 光标往后移动到该行的第 '#' 个位置
   13. gg 进入到文本的开始
2. 删除文字
   1. x 每按一次删除光标所在位置的一个字符
   2. #x 例如 6x 删除光标所在位置的"后面" (包含自己在内) 6 个字符
   3. Shift+x == X 每按一次，删除光标所在位置的前一个字符
   4. Shift+#x == #X 例如 20X 删除光标所在位置的前面 20 个字符
   5. dd 删除光标所在行
   6. #dd 例如 6dd 从光标所在行开始删除 6 行
3. 复制
   1. yw 将光标所在之处到字尾的字符复制到缓冲区中
   2. #yw 例如 6yw 复制 6 个字符到缓冲区
   3. yy 复制光标所在行到缓冲区
   4. #yy 例如 6yy 拷贝从光标所在的该行"往下数" 6 行文字
   5. p 将缓冲区内的字符贴到光标所在位置。注意：所有与 y 有关的复制命令都必须与 p 配合才能完成复制粘贴功能
4. 替换
   1. r 替换光标所在处的字符
   2. R 替换光标所到之处的字符，直到按下 Esc 键为止
5. 撤销上一次的操作
   1. u 回到上一个操作，按动多次 u 可以执行多次回复
6. 更改
   1. cw 更改光标所在处的单词到字尾处
   2. c#w 例如 c3w 表示更改三个单词
7. 跳至指定行
   1. Ctrl+g 列出光标所在行的行号
   2. #G 例如 15G 表示移动光标到文章的第 15 行行首

**5、rm -rf 文件： 删除文件（删）**

## 压缩文件的操作命令

**1、打包并压缩文件**

Linux 中的打包文件一般是以 .tar 结尾的，压缩的文件一般是以 .gz 结尾的。

而一般情况下打包和压缩是一起进行的，打包并压缩后的文件的后缀名一般为 .tar.gz。 命令：

```bash
tar -zcvf 打包压缩后的文件名 要打包压缩的文件
```

其中：

- z：调用 gzip 压缩命令进行压缩
- c：打包文件
- v：显示运行过程
- f：指定文件名

比如：/d/linuxLearn/test 目录下有三个文件分别是：a.txt b.txt c.txt，如果我们要打包 test 目录并指定压缩后的压缩包名称为 test.tar.gz 可以使用命令：

```bash
#不包含test目录
cd /d/linuxLearn/test
tar -zcvf test.tar.gz a.txt b.txt c.txt
#或
tar -zcvf test.tar.gz *
#或
cd /d/linuxLearn
#(最后面还有一个点，不要忘了)
tar -zcvf test.tar.gz -C test/ .

#包含test目录
cd /d/linuxLearn
tar -zcvf test.tar.gz test
#或
tar -zcvf test.tar.gz test/
#或
tar -zcvf test.tar.gz test/*


```

打包的时候需要指定使用何种压缩算法，tar 并不会根据扩展名来调用相应工具。tar 的自动识别仅适用于解包时。

压缩必须指定压缩格式：

- -g: gzip
- -j: bz2
- -J: xz

**2、解压压缩包**

命令：

```bash
tar [-xvf] 压缩文件
```

-x：解压

早期版本的 tar 无法自动判断文件所使用的压缩算法，所以解压时需要指定 z 或 j，现在版本的 tar 都可以识别了，所以解压时不需要指定。

所以对于 gz 格式的解压，在新版 tar 上，以下命令全部等价：

- tar -zxvf
- tar -xvf

示例：

1、将 /test 下的 test.tar.gz 解压到当前目录下可以使用命令：

```bash
tar -xvf test.tar.gz
```



2、将 /test 下的 test.tar.gz 解压到根目录 /usr 下：

```bash
tar -xvf test.tar.gz -C /usr
# -C代表指定解压的位置
```



## Linux 的权限命令

操作系统中每个文件都拥有特定的权限、所属用户和所属组。权限是操作系统用来限制资源访问的机制，在 Linux 中权限一般分为读(readable)、写(writable)和执行(excutable)，分为三组。分别对应文件的属主(owner)，属组(group)和其他用户(other)，通过这样的机制来限制哪些用户、哪些组可以对特定的文件进行什么样的操作。通过 `ls -l` 命令我们可以查看某个目录下的文件或目录的权限。

示例：在目录下 `ls -l`

![](/img-post/2020-10-24-centos7-common/05-01-no.png)

第一列的内容的信息解释如下：

![](/img-post/2020-10-24-centos7-common/05-02-no.png)

下面将详细讲解文件的类型、Linux 中权限以及文件有所有者、所在组、其它组具体是什么。

**文件的类型**

- d： 代表目录
- -： 代表文件
- l： 代表链接（可以认为是 Windows 中的快捷方式）

**Linux 中的权限**

- r：代表权限是可读，r 也可以用数字 4 表示
- w：代表权限是可写，w 也可以用数字 2 表示
- x：代表权限是可执行，x 也可以用数字 1 表示

**文件和目录权限的区别**

对文件和目录而言，读写执行表示不同的意义。

对于文件：

| **权限名称** | **可执行操作**              |
| ------------ | --------------------------- |
| r            | 可以使用 cat 查看文件的内容 |
| w            | 可以修改文件的内容          |
| x            | 可以将其运行为二进制文件    |

对于目录：

| **权限名称** | **可执行操作**           |
| ------------ | ------------------------ |
| r            | 可以查看目录下列表       |
| w            | 可以创建和删除目录下文件 |
| x            | 可以使用 cd 进入目录     |

**在 Linux 中的每个用户必须属于一个组，不能独立于组外。在 Linux 中每个文件有所有者、所在组、其它组的概念**。

- 所有者

一般为文件的创建者，谁创建了该文件，就天然的成为该文件的所有者，用 `ls ‐l` 命令可以看到文件的所有者，也可以使用 `chown 用户名 文件名` 来修改文件的所有者 。

- 文件所在组

当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组 用 `ls ‐l` 命令可以看到文件的所有组，也可以使用 `chgrp 组名 文件名` 来修改文件所在的组。

- 其它组

除开文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组。

我们再来看看如何修改 文件/目录 的权限。

修改 文件/目录 的权限的命令：`chmod`

示例：修改 /test 下的 aaa.txt 的权限为属主有全部权限，属主所在的组有读写权限， 其他用户只有读的权限。

![](/img-post/2020-10-24-centos7-common/05-03-no.png)

上述示例还可以使用数字表示：

```bash
chmod 764 aaa.txt
```

**补充一个比较常用的东西**

假如我们装了一个 ZooKeeper，我们每次开机到要求其自动启动该怎么办？

1. 新建一个脚本 zookeeper
2. 为新建的脚本 zookeeper 添加可执行权限，命令是 `chmod +x zookeeper`
3. 把 zookeeper 这个脚本添加到开机启动项里面，命令是 `chkconfig --add zookeeper`
4. 如果想看看是否添加成功，命令是 `chkconfig --list`

## Linux 用户管理

Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。

用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。

**Linux 用户管理相关命令**

- `useradd 选项 用户名`：添加用户账号
- `userdel 选项 用户名`：删除用户帐号
- `usermod 选项 用户名`：修改帐号
- `passwd 用户名`：更改或创建用户的密码
- `passwd -S 用户名`：显示用户账号密码信息
- `passwd -d 用户名`：清除用户密码
- `su - 用户名`：切换登录用户

`useradd` 命令用于 Linux 中创建的新的系统用户。`useradd` 可用来建立用户帐号。帐号建好之后，再用 `passwd` 设定帐号的密码．而可用 `userdel` 删除帐号。使用 `useradd` 指令所建立的帐号，实际上是保存在 `/etc/passwd` 文本文件中。该文件内容的解释：

用户名:密码:用户id:组id:用户说明:用户的主目录:用户使用的 shell 环境(默认为bash)

`passwd` 命令用于设置用户的认证信息，包括用户密码、密码过期时间等。系统管理者则能用它管理系统用户的密码。只有管理者可以指定用户名称，一般用户只能变更自己的密码。

**Linux 系统用户组的管理相关命令**

- `groupadd 选项 用户组` ：增加一个新的用户组
- `groupdel 用户组` ：要删除一个已有的用户组
- `groupmod 选项 用户组` ：修改用户组的属性

## Linux 系统用户组的管理

每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如 Linux 下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。

## 其他常用命令

- `pwd`： 显示当前所在位置

- `grep 要搜索的字符串 要搜索的文件 --color`： 搜索命令，--color代表高亮显示

- `ps -ef` / `ps aux`： 这两个命令都是查看当前系统正在运行进程，两者的区别是展示格式不同。如果想要查看特定的进程可以使用这样的格式：`ps aux|grep redis` （查看包括 redis 字符串的进程）

  注意：如果直接用`ps`（Process Status）命令，会显示所有进程的状态，通常结合 `grep `命令查看某进程的状态。

- `kill -9 进程的pid`： 杀死进程（-9 表示强制终止）
  先用 `ps` 查找进程，然后用 `kill` 杀掉。

- `ln`： 创建链接文件

  - 创建软链接文件：`ln -s [源文件] [目标文件] `
    - 软链接特点：权限是所有人都可以访问，并且软连接文件指向源文件。
    - 软链接就像 Windows 系统中的快捷方式一样，特点也都类似。
  - 硬链接：硬链接不需 -s 选项，类似 copy，硬链接大小和源文件一样，并且是同步更新的。

- `shutdown`： 

  - `shutdown -h now`： 指定现在立即关机；
  - `shutdown +5 "System will shutdown after 5 minutes"`：指定 5 分钟后关机，同时送出警告信息给登入用户，必须是 root 用户执行。

- `reboot`： 

  - `reboot`： 重开机。
  - `reboot -w`： 做个重开机的模拟（只有纪录并不会真的重开机）。



**网络通信命令**

- 查看当前系统的网卡信息：`ifconfig`
- 查看与某台机器的连接情况：`ping`
- 查看当前系统的端口：`netstat`
  - -an 所有的连接和端口
  - -tuln 查看正在监听 TCP（t）和UDP（u）的端口 ，例如：`netstat -tuln | grep LISTEN`
  - -rn 查看网关 `route -n`

